// Layout Maker ////////////////////////////////////////////////////

.page_wrap.overlay {
  .filter(blur(4px) brightness(0.5) ~'saturate(1.5)' contrast(0.75));
  background-color: darken(#FFF, 0.5%);
}


// Base Styles -----------------------------------------------------

div[class*=col_] {
  background-color: @lightergrey;
  margin-bottom: (@blh);
  padding-top: (@blh);
  position: relative;
  
  div[class*=col_] {
    padding-top: 0;
  }
  
  .content_box {
    margin-bottom: (@blh);
    overflow: hidden;
    
    &.bg {
      background-color: @lightgrey;
      padding: (@gw / 2) (@blh / 2);
    }
  }
  
  &.img_bg {
    background: center center no-repeat;
    .background-size(cover);    
    
    .content_box {
      color: @white;
      
      &.bg {
        background-color: fadeout(@black, 50%);
      }
    }
  }
}

// Editing ---------------------------------------------------------

.edit_mode {
  
  div[class*=col_] {    
    &:before {
      content: attr(class);
      position: absolute;
      top: 0;
      left: 0;
      
      .font-size(10);
      line-height: 20px;
      letter-spacing: 0.1em;
      color: darken(@infocolor, 36%);
      background: fadeout(@white, 50%);
      .padding-x(8px);
      
      .transition(background 0.2s);
    }
    
    &:hover {
      &:before {
        background: fadeout(@white, 10%);
      }
    }
  }
  
  .content_box {
    position: relative;
  
    &:before {
      content: attr(class);
      position: absolute;
      top: 0;
      right: 0;
      
      .font-size(10);
      line-height: 20px;
      letter-spacing: 0.1em;
      color: darken(@errorcolor, 36%);
      background: fadeout(@white, 50%);
      .padding-x(8px);
      
      .transition(background 0.2s);
      z-index: 2000;
    }
    
    &:after {
      content: '';
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      border: 3px solid transparent;
      
      .transition(border-color 0.2s);
    }
    
    &:hover {
    
      &:before {
        background: fadeout(@white, 10%);
      }
      
      &:after {
        border-color: fadeout(@white, 20%);
      }
    }
  }
}


// Column Classes --------------------------------------------------

.col_1 {
  .content_box {
    .column-all(1);
  }
}

.col_2,
.col_3,
.col_4 {
  .content_box {
    .column(1);
  }
}

.col_6 {
  .content_box {
    .column(1/2);
    
    &:nth-child(2n + 1) {
      clear: left;
    }
  }
}

.col_3_2_1 {
  .col_3_2,
  .col_3_1 {
    .column(1);
  }
  
  .col_3_1 .content_box {
    margin-bottom: (@blh * 1.5);
  }
}

.col_4_3_1 {
  .col_4_3,
  .col_4_1 {
    .column(1);
  }
  
  .col_4_1 .content_box {
    margin-bottom: (@blh * 1.5);
    
    h4 {
      line-height: (@blh * 1.5);
    }
  }
}




@media only screen and (min-width: 480px) {
   
  // Column (needs redefining) -------------------------------------
  .column(@fraction) { @gridbits: (@480width / @gutterwidth); @gutterbits: (@gridwidth / @gridbits); @portion: (1 / @fraction); @columnwidth: @gutterbits * ((@gridbits - @portion) * @fraction); float: left; width: @columnwidth; .margin-x(@gutterbits * 0.5); }
  
  // Column Classes ------------------------------------------------
  .col_2,
  .col_3,
  .col_4 {
    .content_box {
      .column(1);
    }
  }
  
  .col_6 {
    .content_box {
      .column(1/2);
      
      &:nth-child(2n + 1) {
        clear: left;
      }
    }
  }
  
  .col_3_2_1 {
    .col_3_2,
    .col_3_1 {
      .column(1);
    }
  }
  
  .col_4_3_1 {
    .col_4_3,
    .col_4_1 {
      .column(1);
    }
  }
  
}


@media only screen and (min-width: 600px) {

  // Column (needs redefining) -------------------------------------
  .column(@fraction) { @gridbits: (@600width / @gutterwidth); @gutterbits: (@gridwidth / @gridbits); @portion: (1 / @fraction); @columnwidth: @gutterbits * ((@gridbits - @portion) * @fraction); float: left; width: @columnwidth; .margin-x(@gutterbits * 0.5); }

  // Column Classes ------------------------------------------------
  .col_2,
  .col_3 {
    .content_box {
      .column(1);
    }
  }
  
  .col_2 {
    .content_box.thumb {
      .column(1/2);
      
      &:nth-child(2n + 1) {
        clear: left;
      }
    }
  }
  
  
  .col_4 {
    .content_box {
      .column(1/2);
      
      &:nth-child(2n + 1) {
        clear: left;
      }
    }
  }
  
  
  .col_6 {
    .content_box {
      .column(1/3);
      
      &:nth-child(2n + 1) {
        clear: none;
      }
      
      &:nth-child(3n + 1) {
        clear: left;
      }
    }
  }
  
  .col_3_2_1 {
    .col_3_2,
    .col_3_1 {
      .column(1);
    }
  }
  
  .col_4_3_1 {
    .col_4_3,
    .col_4_1 {
      .column(1);
    }
  }

}


@media only screen and (min-width: 768px) {

  // Column (needs redefining) -------------------------------------
  .column(@fraction) { @gridbits: (@768width / @gutterwidth); @gutterbits: (@gridwidth / @gridbits); @portion: (1 / @fraction); @columnwidth: @gutterbits * ((@gridbits - @portion) * @fraction); float: left; width: @columnwidth; .margin-x(@gutterbits * 0.5); }

  // Column Classes ------------------------------------------------
  .col_2,
  .col_3 {
    .content_box {
      .column(1);
    }
  }
  
  .col_2 {
    .content_box.thumb {
      .column(1/2);
    }
  }
  
  
  .col_4 {
    .content_box {
      .column(1/2);
      
      &:nth-child(2n + 1) {
        clear: left;
      }
    }
  }
  
  
  .col_6 {
    .content_box {
      .column(1/3);
      
      &:nth-child(2n + 1) {
        clear: none;
      }
      
      &:nth-child(3n + 1) {
        clear: left;
      }
    }
  }
  
  
  .col_3_2_1 {
    .col_3_2,
    .col_3_1 {
      .column(1);
    }
  }
  
  .col_4_3_1 {
    .col_4_3,
    .col_4_1 {
      .column(1);
    }
  }


}


@media only screen and (min-width: 992px) {

  // Column (needs redefining) -------------------------------------
  .column(@fraction) { @gridbits: (@992width / @gutterwidth); @gutterbits: (@gridwidth / @gridbits); @portion: (1 / @fraction); @columnwidth: @gutterbits * ((@gridbits - @portion) * @fraction); float: left; width: @columnwidth; .margin-x(@gutterbits * 0.5); }

  // Column Classes ------------------------------------------------
  .col_2 {
    .content_box {
      .column(1/2);
      
      &:nth-child(2n + 1) {
        clear: left;
      }
      
      
      &.thumb {
        figure {
          float: left;
          width: (@gw * 7);
          margin-top: (@blh);
          margin-right: (@gw);
        }
      }
    }
  }
  
  
  
  .col_3 {
    .content_box {
      .column(1/3);
      
      &:nth-child(3n + 1) {
        clear: left;
      }
    }
  }
  
  
  .col_4 {
    .content_box {
      .column(1/4);
      
      &:nth-child(2n + 1) {
        clear: none;
      }
      
      &:nth-child(4n + 1) {
        clear: left;
      }
    }
  }
  
  
  .col_6 {
    .content_box {
      .column(1/6);
      
      &:nth-child(3n + 1) {
        clear: none;
      }
      
      &:nth-child(6n + 1) {
        clear: left;
      }
    }
  }
  
  
  .col_3_2_1 {
    
    .col_3_2 {
      .column(2/3);
    }
  
    .col_3_1 {
      .column(1/3);
    }
  }
  
  .col_4_3_1 {
    
    .col_4_3 {
      .column(3/4);
    }
  
    .col_4_1 {
      .column(1/4);
    }
  }


}


@media only screen and (min-width: 1382px) {

  // Column (needs redefining) -------------------------------------
  .column(@fraction) { @gridbits: (@1382width / @gutterwidth); @gutterbits: (@gridwidth / @gridbits); @portion: (1 / @fraction); @columnwidth: @gutterbits * ((@gridbits - @portion) * @fraction); float: left; width: @columnwidth; .margin-x(@gutterbits * 0.5); }

  // Column Classes ------------------------------------------------
  .col_2 {
    .content_box {
      .column(1/2);
    }
  }
  
  
  .col_3 {
    .content_box {
      .column(1/3);
    }
  }
  
  
  .col_4 {
    .content_box {
      .column(1/4);
    }
  }
  
  
  .col_6 {
    .content_box {
      .column(1/6);
    }
  }
  
  
  .col_3_2_1 {
    
    .col_3_2 {
      .column(2/3);
    }
  
    .col_3_1 {
      .column(1/3);
    }
  }
  
  .col_4_3_1 {
    
    .col_4_3 {
      .column(3/4);
    }
  
    .col_4_1 {
      .column(1/4);
    }
  }
}











